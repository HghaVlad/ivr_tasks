## STEP 1

<p><strong>Привет!</strong><br>
Это уже вторая глава. После того, как мы ознакомились с самим фреймворком и даже узнали про URL, время приступать к получению запросов и самое главное отправки ответа пользователю. В конце данной главы вам уже предложат выполнить первое практическое задание.<br>
В этой главе мы познакомимся с шаблонами, которые потребуют самостоятельно написания html кода</p>

<p><strong>Что такое представления?</strong></p>

<p>В данном уроке мы узнаем:</p>

<ol>
	<li>Что же вообще такое представление и как происходит связь с пользователем</li>
	<li>Какие бывают способы получения результата клиентом </li>
	<li>Как проходит весь цикл обработки запросов и отправки ответов в Django</li>
</ol>

## STEP 2

<p><strong>Что такое представления?</strong></p>

<p>Обычно пользователь, когда обращается к сайту, ожидает получить в ответе веб-страницу с какими то данными. Для того, чтобы обработать запрос и дать ответ пользователю в django используются именно представления.</p>

<p>Грубо говоря, представление(view) - это функция, которая отвечает за ответ конечному пользователю, то есть отвечает на запрос клиента и отправляют данные, чаще всего это HTML страница. </p>

<p>В Django представления бывают 2 типов:</p>

<ul>
	<li>Представления в виде функций</li>
	<li>Представления в виде классов</li>
</ul>

<p><strong>Как Django обрабатывает запросы:</strong></p>

<p>Весь цикл обработки запроса можно разделить примерно на 11 шагов.</p>

<ol>
	<li>Сервер получает запрос от клиента и срабатывает wsgi-handler </li>
	<li>Запрос передается django. Импортируется файл settings.py и обработчики ошибок</li>
	<li>Загружаются Middleware классы</li>
	<li>Создаются 4 списка методов, которые обрабатывают запросв, представления, ответы и ошибки</li>
	<li>Перебираются методы запроса, выполняя их по порядку</li>
	<li>Передается запрос URL диспетчеру</li>
	<li>Перебираются каждый метод обработки представления</li>
	<li>Вызывается функция, отвечающая за предоставление</li>
	<li>Обрабатываются любые методы исключения</li>
	<li>Перебор каждого методы ответа</li>
	<li>Создается возвращаемое значение и вызывает функцию обратного вызова на веб-сервер</li>
</ol>

<p> </p>

<p>Подробнее можно почитаться здесь: <a href="https://raturi.in/blog/django-request-response-cycle/" rel="noopener noreferrer nofollow">https://raturi.in/blog/django-request-response-cycle/</a></p>

<p><a href="https://www.b-list.org/weblog/2006/jun/13/how-django-processes-request/" rel="noopener noreferrer nofollow">https://www.b-list.org/weblog/2006/jun/13/how-django-processes-request/</a></p>

## STEP 3

<p><strong>Представления в виде функции</strong></p>

<p>Самый распространённый метод обработки запроса пользователя это использования функций, в качестве представления.<br>
В каждом приложении существует файл views.py Именно он отвечает за представления, и в нем мы будем писать наш код.</p>

<pre><code>from django.shortcuts import HttpResponse
# Create your views here.

def home_page(request):
    return HttpResponse("&lt;h1&gt;Hello, World&lt;/h1&gt;")</code></pre>

<p>Вот пример легкой функции, которая возвращает <code>Hello, World</code><br>
Как вы видите функция принимает аргумент request. Это обязательный аргумент и даже если мы никак не используем его, функция должна его принять. После чего возвращается HttpResponse.</p>

<p>Помимо HttpResponse возвращается еще большое количество других типов. Например JsonResponse, Http404, HttpResponseForbidden. Для того, чтобы вернуть html страницу используют функцию render. Подробнее об этом мы ознакомимся в следующем шаге.<br>
Также существует функция redirect. Которая используется для редиректа пользователя.</p>

<p>Внутри функций выполняются разные вычисления, например:</p>

<pre><code>from django.shortcuts import HttpResponse
# Create your views here.

def home_page(request):
    a = 10
    b = 15
    if a + b &lt; 20:
      return HttpResponse("Digits are less than 20")
    else:
      return HttpResponse("Digits are more than 20")</code></pre>

## STEP 4

<p>Сколько существует нормальных способов для написания представления в Django?</p>

- 0
- 2 ✅
- 1
- 3
- 5

## STEP 5

<p>Какой обязательный аргумент принимает функция представления?</p>

- request

## STEP 6

<p><strong>Отправка ответа пользователю</strong></p>

<p>В Django существует несколько способов возврата результатов пользователю. Вот некоторые из них:</p>

<ol>
	<li>
	<p>Render: Самый частый способ возврата результатов клиенту. Используется для генерации HTML-страниц на основе шаблонов и передачи этих страниц клиенту в ответ на HTTP-запросы</p>
	</li>
	<li>
	<p>HttpResponse: Этот объект используется для создания и отправки ответа на запрос клиента. Он может содержать текст, HTML, изображения и другие данные в формате байтовых строк. HttpResponse имеет методы и атрибуты, которые могут быть использованы для работы с ответом, такие как set_cookie(), delete_cookie(), status_code, content, charset и т.д.</p>
	</li>
	<li>
	<p>JsonResponse: Этот объект используется для отправки JSON-данных в ответ на запрос клиента. Он автоматически сериализует данные в формате JSON и устанавливает правильный заголовок Content-Type. JsonResponse имеет методы и атрибуты, которые аналогичны HttpResponse.</p>
	</li>
	<li>
	<p>StreamingHttpResponse: Этот объект используется для создания потокового ответа, который отправляет данные клиенту по мере их готовности, вместо того, чтобы ждать, пока все данные не будут готовы. Он может использоваться, например, для потоковой передачи больших файлов, таких как видео.</p>
	</li>
	<li>
	<p>FileResponse: Этот объект используется для отправки файла в ответ на запрос клиента. Он автоматически устанавливает правильный заголовок Content-Type и Content-Disposition, чтобы браузер мог загрузить файл.</p>
	</li>
	<li>
	<p>HttpResponseRedirect: Этот объект используется для перенаправления пользователя на другую страницу веб-приложения или на другой домен. Он может использоваться, например, для перенаправления пользователя на страницу входа после успешной аутентификации.</p>
	</li>
	<li>
	<p>HttpResponseBadRequest: Этот объект используется для отправки ответа с кодом состояния HTTP 400 Bad Request. Он может использоваться, например, для обработки ошибок пользовательского ввода.</p>
	</li>
</ol>

<p> </p>

<p><strong>Использование функции render()</strong></p>

<p>Для того, чтобы вернуть пользователю html страницу можно использовать функцию render().<br>
Она принимает в качестве параметров объект запроса (<code>request</code>), имя шаблона и контекст - словарь, содержащий переменные, которые будут доступны в шаблоне.  Шаблон - это html файл, который находится в папке templates.<br>
Для начала создайте папку <span style="color: #000000;">templates</span> в директории приложения. В нее вы можете поместить html файл. После чего просто укажите в качестве первого аргумента имя этого файла.</p>

<p>Например, вот пример использования <code>render</code> для отображения страницы "hello.html" с переменной <code>name</code>:</p>

<pre><code># views.py
from django.shortcuts import render

def hello(request):
    name = 'John'
    context = {'name': name}
    return render(request, 'hello.html', context)
</code>
</pre>

<pre><code># templates/hello.html

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Hello&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Hello, {{ name }}!&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code>
</pre>

<p>При выполнении запроса к этому представлению, Django сгенерирует HTML-код на основе шаблона и контекста и вернет его в виде HttpResponse.</p>

<p><code>render</code> - это удобный способ генерации HTML-страниц в Django, который позволяет использовать шаблоны и передавать переменные в эти шаблоны. Это делает веб-разработку более удобной и эффективной.<br>
Подробнее про шаблоны вы узнаете в следующем уроке. </p>

## STEP 7

<p>С помощью какой функции можно вернуть шаблон(html страницу) пользователю?</p>

- render ✅
- HttpResponse
- HtmlResponse
- PageResponse
- JsonResponse
- html
- render_template

## STEP 8

<p>В какой папке хранятся все шаблоны?</p>

- templates
